



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://asit-dhal.github.io/juce/broadcasters-and-listeners-in-juce/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Broadcasters and listeners in JUCE</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-58305706-1", "asit-dhal.github.io")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#broadcasters-and-listeners-in-juce" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://asit-dhal.github.io/" title="Asit Dhal's Personal Blog" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Asit Dhal's Personal Blog
            </span>
            <span class="md-header-nav__topic">
              
                Broadcasters and listeners in JUCE
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://asit-dhal.github.io/" title="Asit Dhal's Personal Blog" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Asit Dhal's Personal Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Git
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Git
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../git/delete-old-branches-in-git/" title="Delete old branches in Git" class="md-nav__link">
      Delete old branches in Git
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Juce
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Juce
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Broadcasters and listeners in JUCE
      </label>
    
    <a href="./" title="Broadcasters and listeners in JUCE" class="md-nav__link md-nav__link--active">
      Broadcasters and listeners in JUCE
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#broadcasters-and-listeners-in-juce" title="Broadcasters and listeners in JUCE" class="md-nav__link">
    Broadcasters and listeners in JUCE
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listeners" title="Listeners" class="md-nav__link">
    Listeners
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-provided-listener" title="User provided Listener" class="md-nav__link">
    User provided Listener
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../side-panel-in-juce/" title="Side Panel in JUCE" class="md-nav__link">
      Side Panel in JUCE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      C++
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        C++
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/string-conversion-benchmark/" title="string conversion benchmark in C++" class="md-nav__link">
      string conversion benchmark in C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/range-generator-algorithms/" title="Range Generator Algorithms" class="md-nav__link">
      Range Generator Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/property-check-agorithims/" title="Property Check Algorithms" class="md-nav__link">
      Property Check Algorithms
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      CMake
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        CMake
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmake/functions-and-macros/" title="Cmake Functions and Macros" class="md-nav__link">
      Cmake Functions and Macros
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmake/custom-command-and-custom-tasks/" title="Custom Commands and Custom Tasks" class="md-nav__link">
      Custom Commands and Custom Tasks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Golang
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Golang
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../golang/golang-templates-1-introduction/" title="Golang Templates-1 Introduction" class="md-nav__link">
      Golang Templates-1 Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../golang/golang-templates-2-template-composition-and-how-to-organize-template-files/" title="Golang Template-2 Template composition" class="md-nav__link">
      Golang Template-2 Template composition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../golang/golang-slice-and-append/" title="Golang slice and append" class="md-nav__link">
      Golang slice and append
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Qt-Qml
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Qt-Qml
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../qt-qml/positioning-with-anchors/" title="Positioning with Anchors" class="md-nav__link">
      Positioning with Anchors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../archives/" title="Archives" class="md-nav__link">
      Archives
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#broadcasters-and-listeners-in-juce" title="Broadcasters and listeners in JUCE" class="md-nav__link">
    Broadcasters and listeners in JUCE
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listeners" title="Listeners" class="md-nav__link">
    Listeners
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-provided-listener" title="User provided Listener" class="md-nav__link">
    User provided Listener
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Broadcasters and listeners in JUCE</h1>
                
                <h2 id="broadcasters-and-listeners-in-juce">Broadcasters and listeners in JUCE<a class="headerlink" href="#broadcasters-and-listeners-in-juce" title="Permanent link">&para;</a></h2>
<p>Juce uses broadcasters and listeners pattern to propagate state changes. This is like classical observer pattern. Broadcasters are subjects and listeners are observers. Juce Framework provides predefined library to automate this process.</p>
<p>Let’s say we have a Window with a slider and a label. When the user changes the slider position, the label will show the value.</p>
<div class="codehilite"><pre><span></span><span class="c1">// MainComponent.h</span>
<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MainComponent</span>   <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">MainComponent</span><span class="p">();</span>
    <span class="o">~</span><span class="n">MainComponent</span><span class="p">();</span>

    <span class="kt">void</span> <span class="nf">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Slider</span> <span class="n">m_valueSlider</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_sliderLabel</span><span class="p">;</span>

    <span class="n">JUCE_DECLARE_NON_COPYABLE_WITH_LEAK_DETECTOR</span> <span class="p">(</span><span class="n">MainComponent</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">// MainComponent.cpp</span>

<span class="cp">#include</span> <span class="cpf">&quot;MainComponent.h&quot;</span><span class="cp"></span>

<span class="n">MainComponent</span><span class="o">::</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_valueSlider</span><span class="p">);</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span> 
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setTextValueSuffix</span><span class="p">(</span><span class="s">&quot; Cnt&quot;</span><span class="p">);</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setTextBoxStyle</span><span class="p">(</span><span class="n">Slider</span><span class="o">::</span><span class="n">TextEntryBoxPosition</span><span class="o">::</span><span class="n">NoTextBox</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_sliderLabel</span><span class="p">);</span>
    <span class="n">m_sliderLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Value&quot;</span><span class="p">,</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="n">setSize</span> <span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">MainComponent</span><span class="o">::~</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">g</span><span class="p">.</span><span class="n">fillAll</span> <span class="p">(</span><span class="n">getLookAndFeel</span><span class="p">().</span><span class="n">findColour</span> <span class="p">(</span><span class="n">ResizableWindow</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">));</span>

    <span class="n">g</span><span class="p">.</span><span class="n">setFont</span> <span class="p">(</span><span class="n">Font</span> <span class="p">(</span><span class="mf">16.0f</span><span class="p">));</span>
    <span class="n">g</span><span class="p">.</span><span class="n">setColour</span> <span class="p">(</span><span class="n">Colours</span><span class="o">::</span><span class="n">white</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">resized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">sliderLeft</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">sliderLeft</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">getWidth</span><span class="p">()</span> <span class="o">-</span> <span class="n">sliderLeft</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="n">m_sliderLabel</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">sliderLeft</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">getWidth</span><span class="p">()</span> <span class="o">-</span> <span class="n">sliderLeft</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>At this moment both the slider and the label don’t interact with each other.</p>
<p>We are going to show the value of slider in the label.</p>
<h3 id="listeners">Listeners<a class="headerlink" href="#listeners" title="Permanent link">&para;</a></h3>
<p>Most Juce components have an inner class called Listener.</p>
<ul>
<li>
<p>This class is an abstract class with at least one pure virtual function. An observer has to inherit from this abstract class and implement the pure virtual function(s). This pure virtual function is the callback.</p>
</li>
<li>
<p>one member function called void addListener(Listener* listener). Using this function, an observer can register it self.</p>
</li>
<li>
<p>another member function called void removeListener(Listener* listener). This one removes the previously registered listener.</p>
</li>
<li>
<p>Whenever a listener is registered, the address is stored in a ListenerList container.</p>
</li>
<li>
<p>Whenever the state changes, the broadcaster iterates over all the registered listeners and calls the appropriate callback.</p>
</li>
</ul>
<p><img alt="Class Diagram of Broadcaster-Listener" src="../images/class-diagram-of-broadcaster-listener.png" /></p>
<p>Slider::Listener provides <code>Slider::Listener::sliderValueChanged( Slider *slide)</code>. We can override that function in the MainComponent. Then register the main component as a listener. In the implementation of sliderValueChanged, we can set the value of the slider in the label.</p>
<div class="codehilite"><pre><span></span><span class="c1">//MainComponent.h </span>
<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MainComponent</span>   <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span><span class="p">,</span>
    <span class="k">public</span> <span class="n">Slider</span><span class="o">::</span><span class="n">Listener</span> <span class="c1">// step 1: inherit the listener abstract class</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">MainComponent</span><span class="p">();</span>
    <span class="o">~</span><span class="n">MainComponent</span><span class="p">();</span>

    <span class="kt">void</span> <span class="nf">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>

    <span class="c1">// step 2: implementation of pure virtual function </span>
    <span class="kt">void</span> <span class="nf">sliderValueChanged</span><span class="p">(</span><span class="n">Slider</span> <span class="o">*</span><span class="n">slider</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Slider</span> <span class="n">m_valueSlider</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_sliderLabel</span><span class="p">;</span>

    <span class="n">JUCE_DECLARE_NON_COPYABLE_WITH_LEAK_DETECTOR</span> <span class="p">(</span><span class="n">MainComponent</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">//MainComponent.cpp</span>
<span class="cp">#include</span> <span class="cpf">&quot;MainComponent.h&quot;</span><span class="cp"></span>

<span class="n">MainComponent</span><span class="o">::</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_valueSlider</span><span class="p">);</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span> 
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setTextValueSuffix</span><span class="p">(</span><span class="s">&quot; Cnt&quot;</span><span class="p">);</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setTextBoxStyle</span><span class="p">(</span><span class="n">Slider</span><span class="o">::</span><span class="n">TextEntryBoxPosition</span><span class="o">::</span><span class="n">NoTextBox</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_sliderLabel</span><span class="p">);</span>
    <span class="n">m_sliderLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Value&quot;</span><span class="p">,</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="n">setSize</span> <span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>

    <span class="c1">// step 3: register the listener</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">addListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">MainComponent</span><span class="o">::~</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// step 5: unregister the listener</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">removeListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">g</span><span class="p">.</span><span class="n">fillAll</span> <span class="p">(</span><span class="n">getLookAndFeel</span><span class="p">().</span><span class="n">findColour</span> <span class="p">(</span><span class="n">ResizableWindow</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">));</span>

    <span class="n">g</span><span class="p">.</span><span class="n">setFont</span> <span class="p">(</span><span class="n">Font</span> <span class="p">(</span><span class="mf">16.0f</span><span class="p">));</span>
    <span class="n">g</span><span class="p">.</span><span class="n">setColour</span> <span class="p">(</span><span class="n">Colours</span><span class="o">::</span><span class="n">white</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">resized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">sliderLeft</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
    <span class="n">m_valueSlider</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">sliderLeft</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">getWidth</span><span class="p">()</span> <span class="o">-</span> <span class="n">sliderLeft</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="n">m_sliderLabel</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">sliderLeft</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">getWidth</span><span class="p">()</span> <span class="o">-</span> <span class="n">sliderLeft</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">sliderValueChanged</span><span class="p">(</span><span class="n">Slider</span> <span class="o">*</span><span class="n">slider</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// step 4: when the value changes, do whatever you want to do.</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">m_valueSlider</span> <span class="o">==</span> <span class="n">slider</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="n">value</span> <span class="o">=</span> <span class="n">slider</span><span class="o">-&gt;</span><span class="n">getValue</span><span class="p">();</span>
        <span class="n">m_sliderLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">value</span><span class="p">))),</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>The broadcaster and listener can have a many to many relationship. One callback can be invoked by many broadcaster. So, you need to know which instanced invoked it. So we do the address comparison in line 44(In this case, it’s not necessary, because we have only one broadcaster.).</p>
<p><img alt="Broadcaster-Listener Demo" src="../images/broadcaste-listener-demo.png" /></p>
<h3 id="user-provided-listener">User provided Listener<a class="headerlink" href="#user-provided-listener" title="Permanent link">&para;</a></h3>
<p>You can also provide your own Listener interface.</p>
<p>Let’s say you have a login form. It has two input boxes, one submit button and one clear button. Clear button is activated when at least one input box has some text and Submit button is activated if both are filled with some data.</p>
<p>We separate the username and password input control to a separate component, called InputForm. In the main component, we have the InputForm and bothe the buttons.</p>
<div class="codehilite"><pre><span></span><span class="c1">// InputForm.h</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">InputForm</span>  <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">InputForm</span><span class="p">();</span>
    <span class="o">~</span><span class="n">InputForm</span><span class="p">();</span>


    <span class="kt">void</span> <span class="nf">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">submit</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">clear</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Label</span> <span class="n">m_usernameLabel</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_passwordLabel</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_usernameInput</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_passwordInput</span><span class="p">;</span>

    <span class="n">JUCE_DECLARE_NON_COPYABLE_WITH_LEAK_DETECTOR</span> <span class="p">(</span><span class="n">InputForm</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">// InputForm.cpp</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;InputForm.h&quot;</span><span class="cp"></span>

<span class="n">InputForm</span><span class="o">::</span><span class="n">InputForm</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_usernameLabel</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Username:&quot;</span><span class="p">,</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">attachToComponent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_usernameInput</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">textColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">orange</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">right</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_passwordLabel</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Password:&quot;</span><span class="p">,</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">attachToComponent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_passwordInput</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">textColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">orange</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">right</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_usernameInput</span><span class="p">);</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">darkblue</span><span class="p">);</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">left</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_passwordInput</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">darkblue</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">left</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">InputForm</span><span class="o">::~</span><span class="n">InputForm</span><span class="p">()</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="p">{</span>

    <span class="n">g</span><span class="p">.</span><span class="n">fillAll</span> <span class="p">(</span><span class="n">getLookAndFeel</span><span class="p">().</span><span class="n">findColour</span> <span class="p">(</span><span class="n">ResizableWindow</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">));</span>   <span class="c1">// clear the background</span>

    <span class="n">g</span><span class="p">.</span><span class="n">setColour</span> <span class="p">(</span><span class="n">Colours</span><span class="o">::</span><span class="n">grey</span><span class="p">);</span>
    <span class="n">g</span><span class="p">.</span><span class="n">drawRect</span> <span class="p">(</span><span class="n">getLocalBounds</span><span class="p">(),</span> <span class="mi">1</span><span class="p">);</span>

<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">resized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">marginX</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">marginY</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">localBounds</span> <span class="o">=</span> <span class="n">getLocalBounds</span><span class="p">();</span>

    <span class="k">auto</span> <span class="n">usernameRect</span> <span class="o">=</span> <span class="n">localBounds</span><span class="p">.</span><span class="n">removeFromTop</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">usernameRect</span><span class="p">.</span><span class="n">removeFromLeft</span><span class="p">(</span><span class="n">usernameRect</span><span class="p">.</span><span class="n">getWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">5</span><span class="p">).</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">,</span> <span class="n">marginY</span><span class="p">));</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">usernameRect</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">,</span> <span class="n">marginY</span><span class="p">));</span>

    <span class="k">auto</span> <span class="n">passwordRect</span> <span class="o">=</span> <span class="n">localBounds</span><span class="p">.</span><span class="n">removeFromTop</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">passwordRect</span><span class="p">.</span><span class="n">removeFromLeft</span><span class="p">(</span><span class="n">passwordRect</span><span class="p">.</span><span class="n">getWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">5</span><span class="p">).</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">));</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">passwordRect</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">,</span> <span class="n">marginY</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">// MainComponent.h</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;InputForm.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MainComponent</span>   <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">MainComponent</span><span class="p">();</span>
    <span class="o">~</span><span class="n">MainComponent</span><span class="p">();</span>

    <span class="kt">void</span> <span class="nf">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">InputForm</span> <span class="n">m_inputForm</span><span class="p">;</span>
    <span class="n">TextButton</span> <span class="n">m_clearButton</span><span class="p">;</span>
    <span class="n">TextButton</span> <span class="n">m_submitButton</span><span class="p">;</span>
    <span class="n">JUCE_DECLARE_NON_COPYABLE_WITH_LEAK_DETECTOR</span> <span class="p">(</span><span class="n">MainComponent</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">// MainComponent.cpp</span>

<span class="cp">#include</span> <span class="cpf">&quot;MainComponent.h&quot;</span><span class="cp"></span>

<span class="n">MainComponent</span><span class="o">::</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_inputForm</span><span class="p">);</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_clearButton</span><span class="p">);</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_submitButton</span><span class="p">);</span>

    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">setButtonText</span><span class="p">(</span><span class="s">&quot;Clear&quot;</span><span class="p">);</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">setButtonText</span><span class="p">(</span><span class="s">&quot;Submit&quot;</span><span class="p">);</span>

    <span class="n">setSize</span> <span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">MainComponent</span><span class="o">::~</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">g</span><span class="p">.</span><span class="n">fillAll</span> <span class="p">(</span><span class="n">getLookAndFeel</span><span class="p">().</span><span class="n">findColour</span> <span class="p">(</span><span class="n">ResizableWindow</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">));</span>

    <span class="n">g</span><span class="p">.</span><span class="n">setFont</span> <span class="p">(</span><span class="n">Font</span> <span class="p">(</span><span class="mf">16.0f</span><span class="p">));</span>
    <span class="n">g</span><span class="p">.</span><span class="n">setColour</span> <span class="p">(</span><span class="n">Colours</span><span class="o">::</span><span class="n">white</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">resized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">localBounds</span> <span class="o">=</span> <span class="n">getLocalBounds</span><span class="p">();</span>
    <span class="k">auto</span> <span class="n">buttonArea</span> <span class="o">=</span> <span class="n">localBounds</span><span class="p">.</span><span class="n">removeFromBottom</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>

    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">buttonArea</span><span class="p">.</span><span class="n">removeFromLeft</span><span class="p">(</span><span class="n">buttonArea</span><span class="p">.</span><span class="n">getWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">).</span><span class="n">reduced</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">buttonArea</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>

    <span class="n">m_inputForm</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">localBounds</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>


<p>We can add a listener interface to the InputForm. It will have to callbacks</p>
<ul>
<li><code>clearActivated()</code></li>
<li><code>submitActivated()</code></li>
</ul>
<p>InputForm must maintain a list of interested listeners and should provide api call for registration and de-registration.</p>
<div class="codehilite"><pre><span></span><span class="c1">// InputForm.h</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">InputForm</span>  <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="c1">// other code</span>
    <span class="k">class</span> <span class="nc">Listener</span>
    <span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="k">virtual</span> <span class="o">~</span><span class="n">Listener</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">clearActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">submitActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kt">void</span> <span class="nf">addListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToAdd</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">removeListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToRemove</span><span class="p">);</span>

    <span class="c1">// ...</span>
<span class="k">private</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">clearActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">submitActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">);</span>

    <span class="c1">// ...</span>
    <span class="kt">bool</span> <span class="n">m_clearActive</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">m_submitActive</span><span class="p">;</span>
    <span class="n">ListenerList</span><span class="o">&lt;</span><span class="n">Listener</span><span class="o">&gt;</span> <span class="n">m_listeners</span><span class="p">;</span>
    <span class="c1">// ....</span>
<span class="p">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">// InputForm.cpp</span>

<span class="n">InputForm</span><span class="o">::</span><span class="n">InputForm</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="n">m_clearActive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="n">m_submitActive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">addListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToAdd</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">listenerToAdd</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">removeListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToRemove</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jassert</span><span class="p">(</span><span class="n">m_listeners</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">listenerToRemove</span><span class="p">));</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listenerToRemove</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">clearActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">call</span><span class="p">([</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">](</span><span class="n">Listener</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span><span class="p">.</span><span class="n">clearActivated</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">);</span> <span class="p">});</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">submitActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">call</span><span class="p">([</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">](</span><span class="n">Listener</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span><span class="p">.</span><span class="n">submitActivated</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">);</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>


<p>Juce ListenerList<T> class should be used to store the list of listeners. It has many advantages than the std lists, like</p>
<ol>
<li>
<p>add or remove listeners from the list during one of the callbacks — i.e. while it’s in the middle of iterating the listeners, then it’s guaranteed that no listeners will be mistakenly called after they’ve been removed, but it may mean that some of the listeners could be called more than once, or not at all, depending on the list’s order.</p>
</li>
<li>
<p>It has a bailout checker(Component::BailOutChecker class) which checks if the component has already been deleted. This provides safety guarantee that no callback will be called on a deleted component.</p>
</li>
<li>
<p>ListenerList checks if the listener is already in the list or not. So, double addition won’t have any effect.</p>
</li>
</ol>
<p>Now, after implementing input and clear logic, the InputForm control looks like this.</p>
<div class="codehilite"><pre><span></span><span class="c1">// InputForm.h</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">InputForm</span>  <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span><span class="p">,</span>
    <span class="k">public</span> <span class="n">Label</span><span class="o">::</span><span class="n">Listener</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">InputForm</span><span class="p">();</span>
    <span class="o">~</span><span class="n">InputForm</span><span class="p">();</span>

    <span class="k">class</span> <span class="nc">Listener</span>
    <span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="k">virtual</span> <span class="o">~</span><span class="n">Listener</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">clearActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">submitActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kt">void</span> <span class="nf">addListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToAdd</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">removeListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToRemove</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>

    <span class="kt">void</span> <span class="nf">labelTextChanged</span><span class="p">(</span><span class="n">Label</span> <span class="o">*</span><span class="n">labelThatHasChanged</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>

    <span class="kt">void</span> <span class="nf">submit</span><span class="p">();</span>
    <span class="kt">void</span> <span class="nf">clear</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">clearActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">submitActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">);</span>

    <span class="n">Label</span> <span class="n">m_usernameLabel</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_passwordLabel</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_usernameInput</span><span class="p">;</span>
    <span class="n">Label</span> <span class="n">m_passwordInput</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="n">m_clearActive</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">m_submitActive</span><span class="p">;</span>
    <span class="n">ListenerList</span><span class="o">&lt;</span><span class="n">Listener</span><span class="o">&gt;</span> <span class="n">m_listeners</span><span class="p">;</span>

    <span class="n">JUCE_DECLARE_NON_COPYABLE_WITH_LEAK_DETECTOR</span> <span class="p">(</span><span class="n">InputForm</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1">// InputForm.cpp</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;InputForm.h&quot;</span><span class="cp"></span>

<span class="n">InputForm</span><span class="o">::</span><span class="n">InputForm</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_usernameLabel</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Username:&quot;</span><span class="p">,</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">attachToComponent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_usernameInput</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">textColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">orange</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">right</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_passwordLabel</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Password:&quot;</span><span class="p">,</span> <span class="n">dontSendNotification</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">attachToComponent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_passwordInput</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">textColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">orange</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">right</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_usernameInput</span><span class="p">);</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">darkblue</span><span class="p">);</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">left</span><span class="p">);</span>

    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_passwordInput</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setEditable</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setColour</span><span class="p">(</span><span class="n">Label</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">,</span> <span class="n">Colours</span><span class="o">::</span><span class="n">darkblue</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setJustificationType</span><span class="p">(</span><span class="n">Justification</span><span class="o">::</span><span class="n">left</span><span class="p">);</span>

    <span class="n">m_clearActive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="n">m_submitActive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">addListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">addListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">InputForm</span><span class="o">::~</span><span class="n">InputForm</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">removeListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">removeListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="p">{</span>

    <span class="n">g</span><span class="p">.</span><span class="n">fillAll</span> <span class="p">(</span><span class="n">getLookAndFeel</span><span class="p">().</span><span class="n">findColour</span> <span class="p">(</span><span class="n">ResizableWindow</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">));</span>   <span class="c1">// clear the background</span>

    <span class="n">g</span><span class="p">.</span><span class="n">setColour</span> <span class="p">(</span><span class="n">Colours</span><span class="o">::</span><span class="n">grey</span><span class="p">);</span>
    <span class="n">g</span><span class="p">.</span><span class="n">drawRect</span> <span class="p">(</span><span class="n">getLocalBounds</span><span class="p">(),</span> <span class="mi">1</span><span class="p">);</span>

<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">resized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">marginX</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">marginY</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">localBounds</span> <span class="o">=</span> <span class="n">getLocalBounds</span><span class="p">();</span>

    <span class="k">auto</span> <span class="n">usernameRect</span> <span class="o">=</span> <span class="n">localBounds</span><span class="p">.</span><span class="n">removeFromTop</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
    <span class="n">m_usernameLabel</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">usernameRect</span><span class="p">.</span><span class="n">removeFromLeft</span><span class="p">(</span><span class="n">usernameRect</span><span class="p">.</span><span class="n">getWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">5</span><span class="p">).</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">,</span> <span class="n">marginY</span><span class="p">));</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">usernameRect</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">,</span> <span class="n">marginY</span><span class="p">));</span>

    <span class="k">auto</span> <span class="n">passwordRect</span> <span class="o">=</span> <span class="n">localBounds</span><span class="p">.</span><span class="n">removeFromTop</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
    <span class="n">m_passwordLabel</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">passwordRect</span><span class="p">.</span><span class="n">removeFromLeft</span><span class="p">(</span><span class="n">passwordRect</span><span class="p">.</span><span class="n">getWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">5</span><span class="p">).</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">));</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">passwordRect</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="n">marginX</span><span class="p">,</span> <span class="n">marginY</span><span class="p">));</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">addListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToAdd</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">listenerToAdd</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">removeListener</span><span class="p">(</span><span class="n">Listener</span><span class="o">*</span> <span class="n">listenerToRemove</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jassert</span><span class="p">(</span><span class="n">m_listeners</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">listenerToRemove</span><span class="p">));</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listenerToRemove</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">clearActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">call</span><span class="p">([</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">](</span><span class="n">Listener</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span><span class="p">.</span><span class="n">clearActivated</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">);</span> <span class="p">});</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">submitActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_listeners</span><span class="p">.</span><span class="n">call</span><span class="p">([</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">](</span><span class="n">Listener</span><span class="o">&amp;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span><span class="p">.</span><span class="n">submitActivated</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">isActive</span><span class="p">);</span> <span class="p">});</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">labelTextChanged</span><span class="p">(</span><span class="n">Label</span> <span class="o">*</span><span class="n">labelThatHasChanged</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="n">atLeastOneTextFilled</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">labelThatHasChanged</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">m_usernameInput</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">atLeastOneTextFilled</span> <span class="o">=</span> <span class="o">!</span><span class="n">m_usernameInput</span><span class="p">.</span><span class="n">getText</span><span class="p">(</span><span class="nb">false</span><span class="p">).</span><span class="n">isEmpty</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">labelThatHasChanged</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">m_passwordInput</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">atLeastOneTextFilled</span> <span class="o">=</span> <span class="o">!</span><span class="n">m_passwordInput</span><span class="p">.</span><span class="n">getText</span><span class="p">(</span><span class="nb">false</span><span class="p">).</span><span class="n">isEmpty</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m_clearActive</span> <span class="o">&amp;&amp;</span> <span class="n">atLeastOneTextFilled</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_clearActive</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">clearActivate</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">m_clearActive</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">atLeastOneTextFilled</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_clearActive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="n">clearActivate</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">allTextFilled</span> <span class="o">=</span> <span class="o">!</span><span class="n">m_usernameInput</span><span class="p">.</span><span class="n">getText</span><span class="p">(</span><span class="nb">true</span><span class="p">).</span><span class="n">isEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">m_passwordInput</span><span class="p">.</span><span class="n">getText</span><span class="p">(</span><span class="nb">true</span><span class="p">).</span><span class="n">isEmpty</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m_submitActive</span> <span class="o">&amp;&amp;</span> <span class="n">allTextFilled</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_submitActive</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">submitActivate</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">m_submitActive</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">allTextFilled</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">m_submitActive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="n">submitActivate</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">submit</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// do nothing</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">clear</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">m_usernameInput</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">NotificationType</span><span class="o">::</span><span class="n">sendNotification</span><span class="p">);</span>
    <span class="n">m_passwordInput</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">NotificationType</span><span class="o">::</span><span class="n">sendNotification</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>When you clear the label programmatically, you need to set the NotificationType. In this case, once the input texts are cleared, we need the callbacks to be called to set the submit and active status. So, we use NotificationType as sendNotification.</p>
<p>In the main component, we implement the InputForm::Listener interface and accordingly set the enabled/disabled status of the buttons.</p>
<div class="codehilite"><pre><span></span><span class="c1">// MainComponent.h</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;../JuceLibraryCode/JuceHeader.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;InputForm.h&quot;</span><span class="cp"></span>

<span class="k">class</span> <span class="nc">MainComponent</span>   <span class="o">:</span> <span class="k">public</span> <span class="n">Component</span><span class="p">,</span>
    <span class="k">public</span> <span class="n">InputForm</span><span class="o">::</span><span class="n">Listener</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">MainComponent</span><span class="p">();</span>
    <span class="o">~</span><span class="n">MainComponent</span><span class="p">();</span>

    <span class="kt">void</span> <span class="nf">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">resized</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>

    <span class="kt">void</span> <span class="nf">clearActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">submitActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">InputForm</span> <span class="n">m_inputForm</span><span class="p">;</span>
    <span class="n">TextButton</span> <span class="n">m_clearButton</span><span class="p">;</span>
    <span class="n">TextButton</span> <span class="n">m_submitButton</span><span class="p">;</span>
    <span class="n">JUCE_DECLARE_NON_COPYABLE_WITH_LEAK_DETECTOR</span> <span class="p">(</span><span class="n">MainComponent</span><span class="p">)</span>
<span class="p">};</span>

<span class="p">{</span><span class="o">%</span> <span class="n">endhighlight</span> <span class="o">%</span><span class="p">}</span>

<span class="p">{</span><span class="o">%</span> <span class="n">highlight</span> <span class="n">cpp</span> <span class="o">%</span><span class="p">}</span>

<span class="c1">// MainComponent.cpp</span>

<span class="cp">#include</span> <span class="cpf">&quot;MainComponent.h&quot;</span><span class="cp"></span>

<span class="n">MainComponent</span><span class="o">::</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_inputForm</span><span class="p">);</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_clearButton</span><span class="p">);</span>
    <span class="n">addAndMakeVisible</span><span class="p">(</span><span class="n">m_submitButton</span><span class="p">);</span>

    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">setButtonText</span><span class="p">(</span><span class="s">&quot;Clear&quot;</span><span class="p">);</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">setButtonText</span><span class="p">(</span><span class="s">&quot;Submit&quot;</span><span class="p">);</span>
    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">m_inputForm</span><span class="p">.</span><span class="n">addListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">onClick</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">]</span> <span class="p">{</span><span class="n">m_inputForm</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span> <span class="p">};</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">onClick</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">]</span> <span class="p">{</span><span class="n">m_inputForm</span><span class="p">.</span><span class="n">submit</span><span class="p">();</span> <span class="p">};</span>

    <span class="n">setSize</span> <span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">MainComponent</span><span class="o">::~</span><span class="n">MainComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">m_inputForm</span><span class="p">.</span><span class="n">removeListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">paint</span> <span class="p">(</span><span class="n">Graphics</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">g</span><span class="p">.</span><span class="n">fillAll</span> <span class="p">(</span><span class="n">getLookAndFeel</span><span class="p">().</span><span class="n">findColour</span> <span class="p">(</span><span class="n">ResizableWindow</span><span class="o">::</span><span class="n">backgroundColourId</span><span class="p">));</span>

    <span class="n">g</span><span class="p">.</span><span class="n">setFont</span> <span class="p">(</span><span class="n">Font</span> <span class="p">(</span><span class="mf">16.0f</span><span class="p">));</span>
    <span class="n">g</span><span class="p">.</span><span class="n">setColour</span> <span class="p">(</span><span class="n">Colours</span><span class="o">::</span><span class="n">white</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">resized</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">localBounds</span> <span class="o">=</span> <span class="n">getLocalBounds</span><span class="p">();</span>
    <span class="k">auto</span> <span class="n">buttonArea</span> <span class="o">=</span> <span class="n">localBounds</span><span class="p">.</span><span class="n">removeFromBottom</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>

    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">buttonArea</span><span class="p">.</span><span class="n">removeFromLeft</span><span class="p">(</span><span class="n">buttonArea</span><span class="p">.</span><span class="n">getWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">).</span><span class="n">reduced</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">buttonArea</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>

    <span class="n">m_inputForm</span><span class="p">.</span><span class="n">setBounds</span><span class="p">(</span><span class="n">localBounds</span><span class="p">.</span><span class="n">reduced</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">clearActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_clearButton</span><span class="p">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">isActive</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">MainComponent</span><span class="o">::</span><span class="n">submitActivated</span><span class="p">(</span><span class="n">InputForm</span><span class="o">*</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isActive</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_submitButton</span><span class="p">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">isActive</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>The application finally looks like this</p>
<p><img alt="Broadcast-Listener Demo" src="../images/broadcaste-listener-demo-final.png" /></p>
<p>Comparison with Qt Signal/Slots</p>
<ol>
<li>
<p>Callbacks are like Slots in Qt. Qt MOC does all the major work of adding code for callback handling. There is no MOC here, so developer has to write everything.</p>
</li>
<li>
<p>In Qt, signal emitters are completely decoupled from signal receivers. So, if you want to add a new signal, it needs minimum amount of code change. In Juce, you will need at least one pure virtual function, code for listener registration and removal.</p>
</li>
<li>
<p>Both Qt and Juce provide asynchronous call by using Qt Event loop and Juce AsyncUpdater respectively. But Juce needs some protection from race condition.</p>
</li>
</ol>
<p>I wrote this blog to clarify my doubts. Feel free to correct if I am wrong or write a comment if you want to suggest something.</p>
<p>The source code is shared here</p>
<p><a href="https://github.com/asit-dhal/Broadcaster-Listener-Demo">https://github.com/asit-dhal/Broadcaster-Listener-Demo</a></p>
                
                  
                
              
              
                


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://asit-dhal.github.io/juce/broadcasters-and-listeners-in-juce/";
      this.page.identifier =
        "juce/broadcasters-and-listeners-in-juce/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//asit-dhal.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../git/delete-old-branches-in-git/" title="Delete old branches in Git" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Delete old branches in Git
              </span>
            </div>
          </a>
        
        
          <a href="../side-panel-in-juce/" title="Side Panel in JUCE" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Side Panel in JUCE
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017-2019 Asit Dhal
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/asit-dhal" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>